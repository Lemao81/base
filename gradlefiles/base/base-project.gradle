import buildSrc.*

ext {
    configureBaseRepositories = { project ->
        project.repositories {
            google()
            jcenter()
            maven { url Url.mavenLocalInternal }
            maven { url Url.maven }
        }
    }

    disableLintTasks = { project ->
        project.tasks.whenTaskAdded { task ->
            if (task.name.startsWith("lint"))
                task.enabled = false
        }
    }

    ignoreRelease = { project ->
        project.afterEvaluate {
            def android = it.extensions.findByName(Extension.android)
            if (android != null) {
                android.variantFilter { variant ->
                    if (variant.buildType.name == BuildType.release)
                        variant.setIgnore(true)
                }
            }
        }
    }

    ignoreDevRelease = { project ->
        project.afterEvaluate {
            def android = it.extensions.findByName(Extension.android)
            if (android != null) {
                android.variantFilter { variant ->
                    if (variant.buildType.name == BuildType.release && variant.getFlavors().get(0).name == Flavor.dev)
                        variant.setIgnore(true)
                }
            }
        }
    }
}

task clean(type: Delete) {
    group 'Cleanup'
    doLast {
        delete rootProject.buildDir
    }
}